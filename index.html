<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dr. Bhavna â€“ Professional Homeopathy Assistant</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{font-family:Arial,sans-serif;background:#eef4fb;margin:0}
header{background:#0f4c75;color:#fff;padding:15px;display:flex;align-items:center}
header img{height:45px;margin-right:12px}
.container{padding:20px;max-width:1200px;margin:auto}

.section{background:#fff;padding:15px;border-radius:8px;margin-bottom:15px}
input,select,button{padding:10px;margin:5px 0;width:100%}
button{background:#0f4c75;color:#fff;border:none;cursor:pointer}
button:hover{background:#083358}

.search-bar{display:grid;grid-template-columns:1fr auto auto;gap:10px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:15px}

.card{background:#fff;padding:15px;border-radius:8px;
box-shadow:0 2px 6px rgba(0,0,0,0.1)}
.card h3{margin:0;color:#0f4c75}
.card hr{border:none;border-top:1px solid #ddd;margin:8px 0}
.card ul{padding-left:18px;margin:5px 0}

.hidden{display:none}
small{color:#555}
.badge{display:inline-block;background:#e8f1f8;color:#0f4c75;
padding:3px 8px;border-radius:5px;font-size:12px}
</style>
</head>

<body>

<header>
<img src="https://i.imgur.com/6XKJZzL.png">
<h2>Dr. Bhavna â€“ Professional Homeopathy Assistant</h2>
</header>

<div class="container">

<!-- SEARCH AREA -->
<div class="section">
<h3>Search by Symptoms</h3>
<div class="search-bar">
<input id="searchInput" placeholder="Enter symptoms (fever, pain, anxietyâ€¦)">
<button onclick="startMic()">ðŸŽ¤</button>
<select id="langToggle">
<option>English</option>
<option>Hindi</option>
</select>
</div>
</div>

<!-- ADMIN LOGIN -->
<div class="section">
<h3>Doctor Login</h3>
<input type="password" id="adminPass" placeholder="Admin password">
<button onclick="loginAdmin()">Login</button>
<p id="loginStatus"></p>
</div>

<!-- PATIENT DETAILS (ADMIN ONLY) -->
<div id="patientSection" class="section hidden">
<h3>Patient Details</h3>
<input id="pName" placeholder="Patient Name">
<input id="pAge" placeholder="Age">
<input id="pComplaint" placeholder="Main Complaint">
<button onclick="generatePDF()">Generate Prescription PDF</button>
</div>

<!-- CSV UPLOAD -->
<div class="section">
<h3>Upload Medicine CSV</h3>
<input type="file" accept=".csv" onchange="loadCSV(event)">
</div>

<!-- MEDICINES -->
<div id="medicineGrid" class="grid"></div>

</div>

<script>
const { jsPDF } = window.jspdf;
let isAdmin = false;
let medicines = [];

function loginAdmin(){
  if(adminPass.value === "admin123"){
    isAdmin = true;
    loginStatus.innerText = "Doctor logged in";
    patientSection.classList.remove("hidden");
  }else{
    loginStatus.innerText = "Invalid password";
  }
}

function loadCSV(e){
  const reader = new FileReader();
  reader.onload = () => parseCSV(reader.result);
  reader.readAsText(e.target.files[0]);
}

function parseCSV(data){
  const rows = data.split("\n").slice(1);
  medicines = rows.map(r=>{
    const c = r.match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g);
    if(!c) return null;
    return {
      name:c[0],
      keynotes:c[1],
      indications:c[2],
      modalities:c[3],
      mind:c[4]
    };
  }).filter(Boolean).slice(0,6);
  renderMedicines();
}

function renderMedicines(){
  medicineGrid.innerHTML="";
  medicines.forEach(m=>{
    medicineGrid.innerHTML+=`
    <div class="card">
      <h3>${m.name}</h3>
      <span class="badge">Homeopathic Remedy</span>
      <hr>
      <b>Key-note Symptoms</b>
      <ul>${m.keynotes.replace(/;/g,"</li><li>")}</ul>
      <b>Indications:</b> ${m.indications}<br>
      <i>Modalities: ${m.modalities}</i><br>
      <small>Mind: ${m.mind}</small>
    </div>`;
  });
}

function generatePDF(){
  if(!isAdmin) return;

  const pdf = new jsPDF();
  pdf.setFontSize(14);
  pdf.text("Dr. Bhavna â€“ Homeopathic Prescription",10,15);
  pdf.setFontSize(11);
  pdf.text(`Patient: ${pName.value}`,10,30);
  pdf.text(`Age: ${pAge.value}`,10,38);
  pdf.text(`Complaint: ${pComplaint.value}`,10,46);

  let y=60;
  medicines.forEach(m=>{
    pdf.text(`â€¢ ${m.name} â€“ ${m.keynotes}`,10,y);
    y+=8;
  });

  y+=10;
  pdf.setFontSize(9);
  pdf.text(
"For professional homeopathic use only. Not a substitute for medical diagnosis.",
10,y
);
  pdf.save("Prescription.pdf");
}

function startMic(){
  alert("Voice input UI ready (speech API can be added)");
}
</script>

</body>
</html>
