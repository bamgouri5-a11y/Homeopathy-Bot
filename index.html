<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dr. Bhavna – Homeopathy Clinical System</title>

<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

<style>
body{background:#eef4fb}
.chat{height:35vh;overflow-y:auto}
.row{display:flex;gap:10px;margin-bottom:12px;max-width:85%}
.bot{align-self:flex-start}
.user{align-self:flex-end;flex-direction:row-reverse}
.avatar{
 width:38px;height:38px;border-radius:50%;
 display:flex;align-items:center;justify-content:center;
 font-weight:bold;color:#fff
}
.botA{background:#16a34a}
.userA{background:#2563eb}
.bubble{background:#fff;padding:12px;border-radius:14px;font-size:14px}
.hidden{display:none}
</style>
</head>

<body class="min-h-screen flex flex-col">

<!-- HEADER -->
<div class="bg-white shadow p-4">
  <div class="max-w-4xl mx-auto flex items-center gap-3 justify-center">
    <img src="doctor-logo.png" class="w-12 h-12 rounded-full border" alt="Doctor Logo">
    <div>
      <h1 class="text-xl font-bold text-blue-700">
        Dr. Bhavna – Homeopathy Consultation System
      </h1>
      <p class="text-xs text-gray-500">
        Classical Homeopathy • Patient Record Management
      </p>
    </div>
  </div>
</div>

<!-- CHAT -->
<div id="chat" class="chat max-w-4xl mx-auto p-4 flex flex-col"></div>

<!-- CHAT INPUT -->
<div class="bg-white p-4 shadow max-w-4xl mx-auto w-full">
  <input id="msg" class="border rounded w-full px-3 py-2 mb-2"
    placeholder="लक्षण लिखें / Type symptoms (Hindi / English)">
  <button onclick="askBot()" class="bg-blue-600 text-white px-4 py-2 rounded w-full">
    Ask Doctor
  </button>
</div>

<!-- PATIENT FORM -->
<div class="max-w-4xl mx-auto mt-4 bg-white p-4 rounded shadow">
<h3 class="font-bold mb-2">Patient Complaint</h3>
<input id="pname" class="border p-2 w-full mb-2 rounded" placeholder="Name">
<input id="pmobile" class="border p-2 w-full mb-2 rounded" placeholder="Mobile">
<input id="page" class="border p-2 w-full mb-2 rounded" placeholder="Age">
<textarea id="paddress" class="border p-2 w-full mb-2 rounded" placeholder="Address"></textarea>
<textarea id="pcomplaint" class="border p-2 w-full mb-2 rounded" placeholder="Complaint"></textarea>
<button onclick="savePatient()" class="bg-green-600 text-white px-4 py-2 rounded w-full">
Save Patient
</button>
</div>

<!-- ADMIN LOGIN -->
<div class="max-w-4xl mx-auto mt-4 bg-gray-100 p-4 rounded shadow">
<h3 class="font-bold text-red-700 mb-2">Admin Login</h3>
<input id="adminUser" class="border p-2 w-full mb-2 rounded" placeholder="Username">
<input id="adminPass" type="password" class="border p-2 w-full mb-2 rounded" placeholder="Password">
<button onclick="adminLogin()" class="bg-red-600 text-white px-4 py-2 rounded w-full">
Login
</button>
</div>

<!-- ADMIN PANEL -->
<div id="adminPanel" class="hidden max-w-4xl mx-auto mt-4 bg-white p-4 rounded shadow">
<h3 class="font-bold mb-3">Admin Panel</h3>

<!-- CSV UPLOAD -->
<label class="block font-semibold mb-1">Upload Patient CSV</label>
<input type="file" accept=".csv" onchange="uploadCSV(this)"
  class="border p-2 w-full mb-3 rounded">

<!-- CSV DOWNLOAD -->
<button onclick="downloadCSV()" class="bg-blue-600 text-white px-4 py-2 rounded w-full">
Download All Patients CSV
</button>
</div>

<footer class="mt-auto bg-white p-3 text-center text-xs text-gray-600">
<strong>Disclaimer:</strong> For clinical reference only
</footer>

<script>
/* ================= CHAT ================= */
const chat=document.getElementById("chat");
function addMsg(text,type="bot"){
 const row=document.createElement("div");
 row.className=`row ${type}`;
 const av=document.createElement("div");
 av.className=`avatar ${type==="bot"?"botA":"userA"}`;
 av.textContent=type==="bot"?"Dr":"You";
 const b=document.createElement("div");
 b.className="bubble";
 b.innerText=text;
 row.append(av,b);
 chat.appendChild(row);
 chat.scrollTop=chat.scrollHeight;
}

/* ================= MEDICINE ENGINE ================= */
const remedies=[
 {med:"Aconitum napellus",sym:["fever","cold","जुकाम","ठंड"]},
 {med:"Belladonna",sym:["headache","सिर","दर्द","heat"]},
 {med:"Bryonia alba",sym:["dry","cough","खांसी"]},
 {med:"Arsenicum album",sym:["anxiety","घबराहट","burning"]},
 {med:"Nux vomica",sym:["gas","acidity","कब्ज"]}
];

function getRemedy(t){
 t=t.toLowerCase();
 let best={s:0,m:null};
 remedies.forEach(r=>{
  let score=0;
  r.sym.forEach(x=>{if(t.includes(x)) score++;});
  if(score>best.s) best={s:score,m:r.med};
 });
 return best.s>0
  ? `Suggested Remedy: ${best.m}\n⚠️ Dose as per physician`
  : "Clear remedy not found. Case taking needed.";
}

function askBot(){
 if(!msg.value.trim()) return;
 addMsg(msg.value,"user");
 setTimeout(()=>addMsg(getRemedy(msg.value),"bot"),400);
 msg.value="";
}

/* ================= PATIENT STORAGE ================= */
let patients=[];
function savePatient(){
 if(!pname.value||!pmobile.value||!page.value||!paddress.value||!pcomplaint.value){
  alert("Fill all fields"); return;
 }
 patients.push({
  name:pname.value,
  mobile:pmobile.value,
  age:page.value,
  address:paddress.value,
  complaint:pcomplaint.value,
  date:new Date().toLocaleString()
 });
 alert("Patient saved");
 pname.value=pmobile.value=page.value=paddress.value=pcomplaint.value="";
}

/* ================= ADMIN ================= */
function adminLogin(){
 if(adminUser.value==="admin" && adminPass.value==="admin123"){
  adminPanel.classList.remove("hidden");
  alert("Admin logged in");
 } else alert("Invalid login");
}

/* ================= CSV UPLOAD ================= */
function uploadCSV(input){
 const file=input.files[0];
 if(!file) return;
 const reader=new FileReader();
 reader.onload=e=>{
  const rows=e.target.result.split("\n").slice(1);
  rows.forEach(r=>{
   const c=r.split(",");
   if(c.length>=5){
    patients.push({
     name:c[0],
     mobile:c[1],
     age:c[2],
     address:c[3],
     complaint:c[4],
     date:c[5]||"Imported"
    });
   }
  });
  alert("CSV Imported Successfully");
 };
 reader.readAsText(file);
}

/* ================= CSV DOWNLOAD ================= */
function downloadCSV(){
 if(!patients.length){alert("No data");return;}
 let csv="Name,Mobile,Age,Address,Complaint,Date\n";
 patients.forEach(p=>{
  csv+=`${p.name},${p.mobile},${p.age},"${p.address}","${p.complaint}",${p.date}\n`;
 });
 const a=document.createElement("a");
 a.href=URL.createObjectURL(new Blob([csv],{type:"text/csv"}));
 a.download="patient_records.csv";
 a.click();
}
</script>

</body>
</html>
